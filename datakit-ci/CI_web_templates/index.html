<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>CI_web_templates (datakit-ci.CI_web_templates)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">datakit-ci</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">CI_web_templates</span></h1></header><p>Generate HTML for the various pages in the UI.</p><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-t.name" class="anchored"><td class="def field"><a href="#type-t.name" class="anchor"></a><code>name : string;</code></td></tr><tr id="type-t.state_repo" class="anchored"><td class="def field"><a href="#type-t.state_repo" class="anchor"></a><code>state_repo : Uri.t option;</code></td></tr><tr id="type-t.metrics_token" class="anchored"><td class="def field"><a href="#type-t.metrics_token" class="anchor"></a><code>metrics_token : [ `SHA256 of Cstruct.t ] option;</code></td></tr><tr id="type-t.listen_addr" class="anchored"><td class="def field"><a href="#type-t.listen_addr" class="anchor"></a><code>listen_addr : [ `HTTP of int | `HTTPS of int ];</code></td></tr><tr id="type-t.github_scopes_needed" class="anchored"><td class="def field"><a href="#type-t.github_scopes_needed" class="anchor"></a><code>github_scopes_needed : Github_t.scope list;</code></td></tr><tr id="type-t.can_read" class="anchored"><td class="def field"><a href="#type-t.can_read" class="anchor"></a><code>can_read : <a href="../CI_ACL/index.html#type-t">CI_ACL.t</a>;</code></td></tr><tr id="type-t.can_build" class="anchored"><td class="def field"><a href="#type-t.can_build" class="anchor"></a><code>can_build : <a href="../CI_ACL/index.html#type-t">CI_ACL.t</a>;</code></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-config"><a href="#val-config" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>config : ?&#8288;name:string <span class="keyword">&#8209;&gt;</span> ?&#8288;state_repo:Uri.t <span class="keyword">&#8209;&gt;</span> ?&#8288;metrics_token:[ `SHA256 of string ] <span class="keyword">&#8209;&gt;</span> ?&#8288;listen_addr:[ `HTTP of int | `HTTPS of int ] <span class="keyword">&#8209;&gt;</span> ?&#8288;github_scopes_needed:Github_t.scope list <span class="keyword">&#8209;&gt;</span> can_read:<a href="../CI_ACL/index.html#type-t">CI_ACL.t</a> <span class="keyword">&#8209;&gt;</span> can_build:<a href="../CI_ACL/index.html#type-t">CI_ACL.t</a> <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p><code class="code">config ~name ~state_repo ()</code> is a web configuration.
If <code class="code">name</code> is given, it is used as the main heading, and also as the name of the session cookie
(useful if you run multiple CIs on the same host, on different ports).
If <code class="code">state_repo</code> is given, it is used to construct links to the state repository on GitHub.</p></div></div><div class="spec type" id="type-page"><a href="#type-page" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>page</code><code><span class="keyword"> = </span>user:string option <span class="keyword">&#8209;&gt;</span> [ `Html ] Tyxml.Html.elt</code><code></code></div><div class="doc"></div></div><div class="spec module" id="module-Error"><a href="#module-Error" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Error/index.html">Error</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec val" id="val-login_page"><a href="#val-login_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>login_page : ?&#8288;github:Uri.t <span class="keyword">&#8209;&gt;</span> csrf_token:string <span class="keyword">&#8209;&gt;</span> <a href="../CI_form/State/index.html#type-t">CI_form.State.t</a> <span class="keyword">&#8209;&gt;</span> is_configured:bool <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-auth_setup"><a href="#val-auth_setup" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>auth_setup : csrf_token:string <span class="keyword">&#8209;&gt;</span> <a href="../CI_form/State/index.html#type-t">CI_form.State.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-user_page"><a href="#val-user_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>user_page : csrf_token:string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-main_page"><a href="#val-main_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>main_page : csrf_token:string <span class="keyword">&#8209;&gt;</span> ci:<a href="../CI_engine/index.html#type-t">CI_engine.t</a> <span class="keyword">&#8209;&gt;</span> dashboards:<a href="../CI_target/index.html#module-Set">CI_target.Set</a>.t Datakit_github.Repo.Map.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-prs_page"><a href="#val-prs_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>prs_page : ci:<a href="../CI_engine/index.html#type-t">CI_engine.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-branches_page"><a href="#val-branches_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>branches_page : ci:<a href="../CI_engine/index.html#type-t">CI_engine.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-tags_page"><a href="#val-tags_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>tags_page : ci:<a href="../CI_engine/index.html#type-t">CI_engine.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-commit_page"><a href="#val-commit_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>commit_page : ?&#8288;test:string <span class="keyword">&#8209;&gt;</span> commit:string <span class="keyword">&#8209;&gt;</span> archived_targets:(<a href="../CI_target/index.html#type-t">CI_target.t</a><span class="keyword"> * </span><a href="../CI_utils/index.html#module-DK">CI_utils.DK</a>.Commit.t) list <span class="keyword">&#8209;&gt;</span> <a href="../CI_target/index.html#type-t">CI_target.t</a> list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-target_page"><a href="#val-target_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>target_page : ?&#8288;test:string <span class="keyword">&#8209;&gt;</span> csrf_token:string <span class="keyword">&#8209;&gt;</span> ?&#8288;title:string <span class="keyword">&#8209;&gt;</span> target:<a href="../CI_target/index.html#type-t">CI_target.t</a> <span class="keyword">&#8209;&gt;</span> <a href="../CI_history/State/index.html#type-t">CI_history.State.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-live_log_frame"><a href="#val-live_log_frame" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>live_log_frame : branch:string <span class="keyword">&#8209;&gt;</span> have_history:bool <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-saved_log_frame"><a href="#val-saved_log_frame" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>saved_log_frame : commit:string <span class="keyword">&#8209;&gt;</span> branch:string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec val" id="val-plain_error"><a href="#val-plain_error" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>plain_error : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"><p>A basic page just the error text and no header, footer, etc.</p></div></div><div class="spec val" id="val-error_page"><a href="#val-error_page" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>error_page : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-page">page</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Settings"><a href="#module-Settings" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Settings/index.html">Settings</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec val" id="val-saved_log_frame_link"><a href="#val-saved_log_frame_link" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>saved_log_frame_link : branch:string <span class="keyword">&#8209;&gt;</span> commit:string <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">saved_log_frame_link ~branch ~commit</code> is the path component of the iframe link for the given saved log.</p></div></div></body></html>