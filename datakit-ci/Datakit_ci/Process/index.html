<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Process (datakit-ci.Datakit_ci.Process)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../index.html">datakit-ci</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Datakit_ci.Process</span></h1></header><h2 id="process" class="anchored"><a href="#process" class="anchor"></a>Extension of Lwt_process</h2><p>Convenience wrappers around <code class="code">Lwt_process</code>.</p><div class="spec val" id="val-run_with_exit_status"><a href="#val-run_with_exit_status" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run_with_exit_status : ?&#8288;switch:Lwt_switch.t <span class="keyword">&#8209;&gt;</span> ?&#8288;log:<a href="../Live_log/index.html#type-t">Live_log.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;cwd:string <span class="keyword">&#8209;&gt;</span> ?&#8288;env:string array <span class="keyword">&#8209;&gt;</span> ?&#8288;stdin:Lwt_process.redirection <span class="keyword">&#8209;&gt;</span> output:(string <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> ?&#8288;stderr:(string <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> ?&#8288;log_cmd:Lwt_process.command <span class="keyword">&#8209;&gt;</span> Lwt_process.command <span class="keyword">&#8209;&gt;</span> Unix.process_status Lwt.t</code></div><div class="doc"><p>Run <code class="code">cmd</code>, passing each chunk of output it produces on stdout to
<code class="code">output</code> and each chunk on stderr to <code class="code">stderr</code>.
If <code class="code">stderr</code> is not given, <code class="code">output</code> is used for both.
Returns the exit status of the process when
completed. If <code class="code">log_cmd</code> is given, it is displayed in all log
messages instead of <code class="code">cmd</code>. This is useful to hide secret
tokens, etc.</p></div></div><div class="spec val" id="val-run"><a href="#val-run" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>run : ?&#8288;switch:Lwt_switch.t <span class="keyword">&#8209;&gt;</span> ?&#8288;log:<a href="../Live_log/index.html#type-t">Live_log.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;cwd:string <span class="keyword">&#8209;&gt;</span> ?&#8288;env:string array <span class="keyword">&#8209;&gt;</span> ?&#8288;stdin:Lwt_process.redirection <span class="keyword">&#8209;&gt;</span> output:(string <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> ?&#8288;stderr:(string <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> ?&#8288;log_cmd:Lwt_process.command <span class="keyword">&#8209;&gt;</span> Lwt_process.command <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"><p>Wrapper for <code class="code">run_with_exit_status</code> that raises an exception if the
process doesn't return an exit status of zero.</p></div></div><div class="spec val" id="val-check_status"><a href="#val-check_status" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>check_status : Lwt_process.command <span class="keyword">&#8209;&gt;</span> Unix.process_status <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">check_status cmd status</code> checks that <code class="code">status</code> is a successful
exit status. If not, it raises an exception giving <code class="code">cmd</code> as the
cause.</p></div></div></body></html>